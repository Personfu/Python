# Palo Alto Firewall Rules — Perimeter Security
# CIS 350 — Network & Cybersecurity | Preston Furulie

# Rule 1: Allow HTTPS to DMZ web servers
set rulebase security rules "Allow-HTTPS-DMZ" \
    from untrust to dmz \
    source any destination "DMZ-WebServers" \
    application ssl service application-default \
    action allow log-start yes

# Rule 2: Allow corporate to internal servers
set rulebase security rules "Corp-to-Servers" \
    from vlan20 to vlan30 \
    source "Corporate-Subnet" destination "Server-Subnet" \
    application any service application-default \
    action allow log-start yes

# Rule 3: Block guest network from internal
set rulebase security rules "Block-Guest-Internal" \
    from vlan40 to any \
    source "Guest-Subnet" destination "RFC1918" \
    action deny log-start yes

# Rule 4: Allow guest internet only
set rulebase security rules "Guest-Internet" \
    from vlan40 to untrust \
    source "Guest-Subnet" destination any \
    application web-browsing ssl dns \
    action allow

# Rule 5: Implicit deny all
set rulebase security rules "Deny-All" \
    from any to any \
    source any destination any \
    action deny log-start yes
